<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">
<!--
generated by Pygments <https://pygments.org/>
Copyright 2006-2020 by the Pygments team.
Licensed under the BSD license, see LICENSE for details.
-->
<html>
<head>
  <title></title>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <style type="text/css">
/*
generated by Pygments <https://pygments.org/>
Copyright 2006-2020 by the Pygments team.
Licensed under the BSD license, see LICENSE for details.
*/
pre { line-height: 125%; margin: 0; }
td.linenos pre { color: #000000; background-color: #f0f0f0; padding-left: 5px; padding-right: 5px; }
span.linenos { color: #000000; background-color: #f0f0f0; padding-left: 5px; padding-right: 5px; }
td.linenos pre.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
body .hll { background-color: #ffffcc }
body { background: #f8f8f8; }
body .c { color: #408080; font-style: italic } /* Comment */
body .err { border: 1px solid #FF0000 } /* Error */
body .k { color: #008000; font-weight: bold } /* Keyword */
body .-MMT_DD { color: #D3D3D3 } /* MMT_DD */
body .-MMT_MD { color: #D3D3D3 } /* MMT_MD */
body .-MMT_OD { color: #D3D3D3 } /* MMT_OD */
body .o { color: #666666 } /* Operator */
body .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
body .cm { color: #408080; font-style: italic } /* Comment.Multiline */
body .cp { color: #BC7A00 } /* Comment.Preproc */
body .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
body .c1 { color: #408080; font-style: italic } /* Comment.Single */
body .cs { color: #408080; font-style: italic } /* Comment.Special */
body .gd { color: #A00000 } /* Generic.Deleted */
body .ge { font-style: italic } /* Generic.Emph */
body .gr { color: #FF0000 } /* Generic.Error */
body .gh { color: #000080; font-weight: bold } /* Generic.Heading */
body .gi { color: #00A000 } /* Generic.Inserted */
body .go { color: #888888 } /* Generic.Output */
body .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
body .gs { font-weight: bold } /* Generic.Strong */
body .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
body .gt { color: #0044DD } /* Generic.Traceback */
body .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
body .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
body .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
body .kp { color: #008000 } /* Keyword.Pseudo */
body .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
body .kt { color: #B00040 } /* Keyword.Type */
body .m { color: #666666 } /* Literal.Number */
body .s { color: #BA2121 } /* Literal.String */
body .na { color: #7D9029 } /* Name.Attribute */
body .nb { color: #008000 } /* Name.Builtin */
body .nc { color: #0000FF; font-weight: bold } /* Name.Class */
body .no { color: #880000 } /* Name.Constant */
body .nd { color: #AA22FF } /* Name.Decorator */
body .ni { color: #999999; font-weight: bold } /* Name.Entity */
body .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
body .nf { color: #0000FF } /* Name.Function */
body .nl { color: #A0A000 } /* Name.Label */
body .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
body .nt { color: #008000; font-weight: bold } /* Name.Tag */
body .nv { color: #19177C } /* Name.Variable */
body .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
body .w { color: #bbbbbb } /* Text.Whitespace */
body .mb { color: #666666 } /* Literal.Number.Bin */
body .mf { color: #666666 } /* Literal.Number.Float */
body .mh { color: #666666 } /* Literal.Number.Hex */
body .mi { color: #666666 } /* Literal.Number.Integer */
body .mo { color: #666666 } /* Literal.Number.Oct */
body .sa { color: #BA2121 } /* Literal.String.Affix */
body .sb { color: #BA2121 } /* Literal.String.Backtick */
body .sc { color: #BA2121 } /* Literal.String.Char */
body .dl { color: #BA2121 } /* Literal.String.Delimiter */
body .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
body .s2 { color: #BA2121 } /* Literal.String.Double */
body .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
body .sh { color: #BA2121 } /* Literal.String.Heredoc */
body .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
body .sx { color: #008000 } /* Literal.String.Other */
body .sr { color: #BB6688 } /* Literal.String.Regex */
body .s1 { color: #BA2121 } /* Literal.String.Single */
body .ss { color: #19177C } /* Literal.String.Symbol */
body .bp { color: #008000 } /* Name.Builtin.Pseudo */
body .fm { color: #0000FF } /* Name.Function.Magic */
body .vc { color: #19177C } /* Name.Variable.Class */
body .vg { color: #19177C } /* Name.Variable.Global */
body .vi { color: #19177C } /* Name.Variable.Instance */
body .vm { color: #19177C } /* Name.Variable.Magic */
body .il { color: #666666 } /* Literal.Number.Integer.Long */

  </style>
</head>
<body>
<h2></h2>

<div class="highlight"><pre><span></span><span class="kn">namespace</span><span class="w"> </span><span class="l l-URI">http://cds.omdoc.org/examples/linear</span><span class=" -MMT_MD">❚</span><span class="w"></span>

<span class="kn">import</span><span class="w"> </span><span class="nn">rules</span><span class="w"> </span><span class="l l-URI">scala://examples.mmt.kwarc.info</span><span class=" -MMT_MD">❚</span><span class="w"></span>

<span class="cm">// Linear logic</span>
<span class="cm">   Syntax: intuitionistic linear logic</span>
<span class="cm">   Proof theory: resource semantics based on Frank Pfenning&#39;s lecture notes</span>
<span class="cm">   (http://www.cs.cmu.edu/~fp/courses/15816-s10/schedule.html, Lecture 23-24) resource semantics</span>
<span class="cm">❚</span><span class="w"></span>

<span class="kd">theory</span><span class="w"> </span><span class="nc">Syntax</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="l l-URI">http://cds.omdoc.org/urtheories?LF</span><span class="w"> </span><span class="p">=</span><span class="w"></span>
<span class="w">   </span><span class="vc">o</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">type</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">⊗</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">o ⟶ o ⟶ o </span><span class=" -MMT_OD">❘</span><span class="p">#</span><span class="w"> </span><span class="si">1</span><span class="w"> </span><span class="ss">⊗</span><span class="w"> </span><span class="si">2</span><span class="w"> </span><span class="k">prec</span><span class="w"> </span><span class="mi">100</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">o</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">&amp;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">o ⟶ o ⟶ o </span><span class=" -MMT_OD">❘</span><span class="p">#</span><span class="w"> </span><span class="si">1</span><span class="w"> </span><span class="ss">&amp;</span><span class="w"> </span><span class="si">2</span><span class="w"> </span><span class="k">prec</span><span class="w"> </span><span class="mi">100</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">⊤</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">o</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">⊕</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">o ⟶ o ⟶ o </span><span class=" -MMT_OD">❘</span><span class="p">#</span><span class="w"> </span><span class="si">1</span><span class="w"> </span><span class="ss">⊕</span><span class="w"> </span><span class="si">2</span><span class="w"> </span><span class="k">prec</span><span class="w"> </span><span class="mi">100</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">0</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">o</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">⊸</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">o ⟶ o ⟶ o </span><span class=" -MMT_OD">❘</span><span class="p">#</span><span class="w"> </span><span class="si">1</span><span class="w"> </span><span class="ss">⊸</span><span class="w"> </span><span class="si">2</span><span class="w"> </span><span class="k">prec</span><span class="w"> </span><span class="mi">80</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">!</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">o ⟶ o      </span><span class=" -MMT_OD">❘</span><span class="p">#</span><span class="w"> </span><span class="ss">!</span><span class="w"> </span><span class="si">1</span><span class="w"> </span><span class="k">prec</span><span class="w"> </span><span class="mi">110</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span>
<span class="w">   </span><span class="vc">⇒</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">o ⟶ o ⟶ o </span><span class=" -MMT_OD">❘</span><span class="p">#</span><span class="w"> </span><span class="si">1</span><span class="w"> </span><span class="ss">⇒</span><span class="w"> </span><span class="si">2</span><span class="w"> </span><span class="k">prec</span><span class="w"> </span><span class="mi">80</span><span class=" -MMT_OD">❘</span><span class="w"></span>
<span class="w">     </span><span class="p">=</span><span class="w"> </span><span class=" -MMT_ObjectExpression">[x,y] !x ⊸ y</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class=" -MMT_MD">❚</span><span class="w"></span>

<span class="cm">// We use untyped first-order logic with equality to define the sematnics.</span>
<span class="cm">   The values of the first-order universe are the worlds, and propositions may hold at different worlds.❚</span><span class="w"></span>

<span class="kd">theory</span><span class="w"> </span><span class="nc">Worlds</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="l l-URI">/examples?FOLEQNatDed</span><span class="w"> </span><span class="p">=</span><span class="w"> </span>
<span class="w">   </span><span class="kn">include</span><span class="w"> </span><span class="l l-URI">?Syntax</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="cm">// worlds contain resources ❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">world</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">type</span><span class=" -MMT_OD">❘</span><span class="p">=</span><span class="w"> </span><span class=" -MMT_ObjectExpression">term</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="cm">// composition of worlds, corresponds to multiset union of resources ❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">union</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">world ⟶ world ⟶ world </span><span class=" -MMT_OD">❘</span><span class="p">#</span><span class="w"> </span><span class="si">1</span><span class="w"> </span><span class="ss">*</span><span class="w"> </span><span class="si">2</span><span class="w"> </span><span class="k">prec</span><span class="w"> </span><span class="mi">100</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="cm">// empty world with no resources ❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">empty</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">world</span><span class=" -MMT_OD">❘</span><span class="p">#</span><span class="w"> </span><span class="ss">ε</span><span class=" -MMT_DD">❙</span><span class="w"></span>

<span class="w">   </span><span class="cm">// * is a monoid❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">neutL</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{P} ⊦ ε*P ≐ P</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">neutR</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{P} ⊦ P*ε ≐ P</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">assoc</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{P,Q,R} ⊦ (P*Q)*R ≐ P*(Q*R)</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span>
<span class="w">   </span><span class="cm">// A @ P: A can be produced by using all resources available in world P❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">at</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">o ⟶ world ⟶ prop</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">At</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">o ⟶ world ⟶ type</span><span class=" -MMT_OD">❘</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class=" -MMT_ObjectExpression">[p,w] ⊦ at p w</span><span class=" -MMT_OD">❘</span><span class="p">#</span><span class="w"> </span><span class="si">1</span><span class="w"> </span><span class="ss">@</span><span class="w"> </span><span class="si">2</span><span class="w"> </span><span class="k">prec</span><span class="w"> </span><span class="mi">50</span><span class=" -MMT_OD">❘</span><span class="k">role</span><span class="w"> </span><span class=" -MMT_ObjectExpression">Judgment</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="cm">// a formula is valid if it holds in the empty world❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">valid</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">o ⟶ type </span><span class=" -MMT_OD">❘</span><span class="p">=</span><span class="w"> </span><span class=" -MMT_ObjectExpression">[A] A @ ε</span><span class=" -MMT_OD">❘</span><span class="p">#</span><span class="w"> </span><span class="ss">valid</span><span class="w"> </span><span class="si">1</span><span class="w"> </span><span class="k">prec</span><span class="w"> </span><span class="mi">-10</span><span class=" -MMT_DD">❙</span><span class="w"> </span>
<span class="w">   </span>
<span class=" -MMT_MD">❚</span><span class="w"></span>

<span class="cm">// Apart from the monoid/multiset structure, there is no way to introduce worlds.</span>
<span class="cm">   The set of worlds is the freely-generated T over the bound world variables.</span>
<span class="cm">   Here T is the theory imposed on worlds, T is an extension of the monoid theory.</span>

<span class="cm">   Different extensions allow modeling different structural rules.</span>
<span class="cm">   The following gives three extensions, but only Exchange is used later on.❚</span><span class="w"></span>

<span class="cm">// Exchange corresponds to commutativity.❚</span><span class="w"></span>
<span class="kd">theory</span><span class="w"> </span><span class="nc">Exchange</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="l l-URI">/examples?FOLEQNatDed</span><span class="w"> </span><span class="p">=</span><span class="w"></span>
<span class="w">  </span><span class="kn">include</span><span class="w"> </span><span class="l l-URI">?Worlds</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">comm</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{P,Q} ⊦ P*Q ≐ Q*P</span><span class=" -MMT_DD">❙</span><span class="w"></span>

<span class="w">   </span><span class="cm">// We add two special type-checking rules that mechanize the monoid+commutativity axiom.</span>
<span class="cm">      Their implementations are given in the folder scala (sibling of source).❙</span><span class="w"></span>
<span class="w">   </span>
<span class="w">   </span><span class="cm">// A simplification rule for *-terms: it normalizes bracketing of *, drops ε, and reorders the arguments❙</span><span class="w"></span>
<span class="w">   </span><span class="kn">rule</span><span class="w"> </span><span class="l l-URI">rules?NormalizeWorlds</span><span class=" -MMT_DD">❙</span><span class="w"></span>

<span class="w">   </span><span class="vc">test</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{p,q,r} ⊦ r*(p*q)*ε*r ≐ r*(r*(q*p)) </span><span class=" -MMT_OD">❘</span><span class="p">=</span><span class="w"> </span><span class=" -MMT_ObjectExpression">[p,q,r] refl</span><span class=" -MMT_DD">❙</span><span class="w"></span>

<span class="w">   </span><span class="cm">// An equality-checking rule for equations involving *: it normalizes both sides and solves meta-variables of type world.</span>
<span class="cm">      For example, it can reduce v*w=v*w&#39; to w=w&#39;.</span>
<span class="cm">      Situations like this came up in several of the examples below.</span>
<span class="cm">      This rule is admissible for solving meta-variables but not derivable from the monoid+commutativity axioms.</span>
<span class="cm">      Effectively, it works in the freely-generated commutative monoid.</span>
<span class="cm">      Because it is only admissible, it breaks modularity: e.g., it cannot be easily combined with a corresponding rule for idempotence.❙</span><span class="w"></span>
<span class="w">   </span><span class="kn">rule</span><span class="w"> </span><span class="l l-URI">rules?EquateWorlds</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class=" -MMT_MD">❚</span><span class="w"></span>

<span class="cm">// Contraction corresponds to idempotence.❚</span><span class="w"></span>
<span class="kd">theory</span><span class="w"> </span><span class="nc">Contraction</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="l l-URI">/examples?FOLEQNatDed</span><span class="w"> </span><span class="p">=</span><span class="w"></span>
<span class="w">  </span><span class="kn">include</span><span class="w"> </span><span class="l l-URI">?Worlds</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">  </span><span class="vc">idem</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{P} ⊦ P*P ≐ P</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class=" -MMT_MD">❚</span><span class="w"></span>

<span class="cm">// Weakening corresponds to the empty world being the least element.❚</span><span class="w"></span>
<span class="kd">theory</span><span class="w"> </span><span class="nc">Weakening</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="l l-URI">/examples?FOLEQNatDed</span><span class="w"> </span><span class="p">=</span><span class="w"></span>
<span class="w">  </span><span class="kn">include</span><span class="w"> </span><span class="l l-URI">?Worlds</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="cm">// ordering with monotonicity❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">weaker</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">world ⟶ world ⟶ prop </span><span class=" -MMT_OD">❘</span><span class="w"> </span><span class="p">#</span><span class="w"> </span><span class="si">1</span><span class="w"> </span><span class="ss">≤</span><span class="w"> </span><span class="si">2</span><span class="w"> </span><span class="k">prec</span><span class="w"> </span><span class="mi">80</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">≤_refl</span><span class="w">   </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{P} ⊦ P ≤ P</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">≤_antisym</span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{P,Q} ⊦ P ≤ Q ⟶ ⊦ Q ≤ P ⟶ ⊦ P≐Q</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">≤_trans</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{P,Q,R} ⊦ P≤Q ⟶ ⊦ Q≤R ⟶ ⊦ P≤R </span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">≤_monotone</span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{a,b,c,d} ⊦ a ≤ b ⟶ ⊦ c ≤ d ⟶ ⊦ a*c ≤ b*d</span><span class=" -MMT_DD">❙</span><span class="w"> </span>

<span class="w">   </span><span class="cm">// least world (without this, the order is trivial, i.e., there is no weakening)❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">≤_least</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{P} ⊦ ε ≤ P</span><span class=" -MMT_DD">❙</span><span class="w"></span>

<span class="w">   </span><span class="cm">// TODO: This should be a subtyping rule so that it does not occur in proofs.❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">weaken</span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{A,v,w} A @ v ⟶ ⊦v≤w ⟶ A @ w</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span>
<span class="w">   </span><span class="vc">divisibility</span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{P,Q} ⊦ P ≤ P*Q </span><span class=" -MMT_OD">❘</span><span class="w"></span>
<span class="w">               </span><span class="p">=</span><span class="w"> </span><span class=" -MMT_ObjectExpression">[P,Q] congF neutR ([u]u≤P*Q) (≤_monotone ≤_refl ≤_least)</span><span class=" -MMT_DD">❙</span><span class="w"> </span>
<span class=" -MMT_MD">❚</span><span class="w"></span>

<span class="cm">// Now proofs of the linear sequent A1, ..., An |- A are represented as terms of type</span>
<span class="cm">   (A1 ⊗ ... ⊗ An) ⊸ A  @  ε, where @ is the binary holds-at relation between propositions and worlds.❚</span><span class="w"></span>
<span class="kd">theory</span><span class="w"> </span><span class="nc">ResourceSemantics</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="l l-URI">/examples?FOLEQNatDed</span><span class="w"> </span><span class="p">=</span><span class="w"></span>
<span class="w">   </span><span class="kn">include</span><span class="w"> </span><span class="l l-URI">?Worlds</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="kn">include</span><span class="w"> </span><span class="l l-URI">?Exchange</span><span class=" -MMT_DD">❙</span><span class="w"></span>

<span class="w">   </span><span class="vc">⊗_R</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{A,B,a,b} A @ a ⟶ B @ b ⟶ A ⊗ B @ a*b</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">⊗_L</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{A,B,C,u,v} A ⊗ B @ u ⟶ ({a}{b} A @ a ⟶ B @ b ⟶ C @ a*b*v) ⟶ C @ u*v</span><span class=" -MMT_OD">❘</span><span class="w"></span>
<span class="w">   </span><span class="p">#</span><span class="w"> </span><span class="ss">⊗_L</span><span class="w"> </span><span class="si">6</span><span class="w"> </span><span class="si">7</span><span class=" -MMT_DD">❙</span><span class="w"></span>

<span class="w">   </span><span class="vc">1_R</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">1 @ ε</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">1_L</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{C,u,v} 1 @ u ⟶ C @ v ⟶ C @ u*v</span><span class=" -MMT_DD">❙</span><span class="w"></span>

<span class="w">   </span><span class="vc">&amp;_R</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{A,B,w} A @ w ⟶ B @ w ⟶ A &amp; B @ w</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">&amp;_Ll</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{A,B,C,u,v} A &amp; B @ u ⟶ ({a} A @ a ⟶ C @ a*v) ⟶ C @ u*v</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">&amp;_Lr</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{A,B,C,u,v} A &amp; B @ u ⟶ ({b} B @ b ⟶ C @ b*v) ⟶ C @ u*v</span><span class=" -MMT_DD">❙</span><span class="w"></span>

<span class="w">   </span><span class="vc">⊤_R</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{w} ⊤ @ w</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span>
<span class="w">   </span><span class="vc">⊕_Rl</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{A,B,w} A @ w ⟶ A ⊕ B @ w</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">⊕_Rr</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{A,B,w} B @ w ⟶ A ⊕ B @ w</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">⊕_L</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{A,B,C,u,v} A ⊕ B @ u ⟶ ({a} A @ a ⟶ C @ a*v) ⟶ ({b} B @ b ⟶ C @ b*v) ⟶ C @ u*v</span><span class=" -MMT_DD">❙</span><span class="w">  </span>

<span class="w">   </span><span class="vc">0_L</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{C,u,v} 0 @ u ⟶ C @ u*v</span><span class=" -MMT_DD">❙</span><span class="w"> </span>
<span class="w">   </span>
<span class="w">   </span><span class="vc">⊸_R</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{A,B,w} ({a} A @ a ⟶ B @ a*w) ⟶ A ⊸ B @ w</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">⊸_L</span><span class="w">  </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{A,B,C,u,a,v} A ⊸ B @ u ⟶ A @ a ⟶ ({b} B @ b ⟶ C @ b*v) ⟶ C @ u*a*v</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="cm">// alternatively</span>
<span class="cm">   ⊸_E  : A ⊸ B @ P ⟶ A @ Q ⟶ B @ P*Q</span>
<span class="cm">   ⊸_L : A ⊸ B @ H ⟶ A @ P ⟶ ({b} B @ b ⟶ C @ b*Q) ⟶ C @ H*P*Q</span>
<span class="cm">      = [p][q][f] f (H*P) (⊸E p q)</span>
<span class="cm">   ❙</span><span class="w"></span>

<span class="w">   </span><span class="vc">!_R</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{A} A @ ε ⟶ ! A @ ε</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">!_L</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{A,C,u,v} ! A @ u ⟶ (A @ ε ⟶ C @ v) ⟶ C @ u*v</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span>
<span class="w">   </span>
<span class="w">   </span><span class="cm">// In the remainder, we prove some derivable rules to exercise the calculus.❙</span><span class="w"></span>
<span class="w">   </span>
<span class="w">   </span><span class="vc">⊗_commute</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{A,B} valid A⊗B ⊸ B⊗A</span><span class=" -MMT_OD">❘</span><span class="w"></span>
<span class="w">      </span><span class="p">=</span><span class="w"> </span><span class=" -MMT_ObjectExpression">[A,B] ⊸_R [ab,h] ⊗_L h [a,b,p,q] ⊗_R q p</span><span class=" -MMT_DD">❙</span><span class="w"></span>

<span class="w">   </span><span class="cm">// needs to solve abc * X = abc and ab * Y * X = ab * c, solution: X = epsilon, Y = c❙</span><span class="w"> </span>
<span class="w">   </span><span class="vc">⊗_assoc1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{A,B,C} valid (A⊗B)⊗C ⊸ A⊗(B⊗C)</span><span class=" -MMT_OD">❘</span><span class="w"></span>
<span class="w">        </span><span class="p">=</span><span class="w"> </span><span class=" -MMT_ObjectExpression">[A,B,C] ⊸_R [abc,h] ⊗_L h </span>
<span class=" -MMT_ObjectExpression">              [ab,c,pq,r] ⊗_L pq</span>
<span class=" -MMT_ObjectExpression">                 ([a,b,p,q] ⊗_R p (⊗_R q r))</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">      </span>
<span class="w">   </span><span class="vc">⊗_assoc2</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{A,B,C} valid A⊗(B⊗C) ⊸ (A⊗B)⊗C</span><span class=" -MMT_OD">❘</span><span class="w"></span>
<span class="w">        </span><span class="p">=</span><span class="w"> </span><span class=" -MMT_ObjectExpression">[A,B,C] ⊸_R [abc,h] ⊗_L h </span>
<span class=" -MMT_ObjectExpression">              [a,bc,p,qr] ⊗_L qr</span>
<span class=" -MMT_ObjectExpression">                 ([b,c,q,r] ⊗_R (⊗_R p q) r)</span><span class=" -MMT_DD">❙</span><span class="w"></span>

<span class="w">   </span><span class="vc">⊗_neutral1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{A} valid A⊗1 ⊸ A</span><span class=" -MMT_OD">❘</span><span class="w"></span>
<span class="w">      </span><span class="p">=</span><span class="w"> </span><span class=" -MMT_ObjectExpression">[A] ⊸_R [ao,h] ⊗_L h [a,b,p,q] 1_L q p</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">⊗_neutral2</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{A} valid A ⊸ A⊗1</span><span class=" -MMT_OD">❘</span><span class="w"></span>
<span class="w">      </span><span class="p">=</span><span class="w"> </span><span class=" -MMT_ObjectExpression">[A] ⊸_R [a,h] ⊗_R h 1_R</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">      </span>
<span class="w">   </span><span class="vc">⊕_commute</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{A,B} valid A⊕B ⊸ B⊕A</span><span class=" -MMT_OD">❘</span><span class="w"></span>
<span class="w">      </span><span class="p">=</span><span class="w"> </span><span class=" -MMT_ObjectExpression">[A,B] ⊸_R [ab,h] ⊕_L h ([a,p] ⊕_Rr p) ([b,q] ⊕_Rl q)</span><span class=" -MMT_DD">❙</span><span class="w"></span>

<span class="w">   </span><span class="vc">⊕_neutral1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{A} valid A⊕0 ⊸ A</span><span class=" -MMT_OD">❘</span><span class="w"></span>
<span class="w">    </span><span class="p">=</span><span class="w"> </span><span class=" -MMT_ObjectExpression">[A] ⊸_R [az,h] ⊕_L h ([a,p] p) ([z,q] 0_L q)</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">⊕_neutral2</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{A} valid A ⊸ A⊕0</span><span class=" -MMT_OD">❘</span><span class="w"></span>
<span class="w">      </span><span class="p">=</span><span class="w"> </span><span class=" -MMT_ObjectExpression">[A] ⊸_R [a,h] ⊕_Rl h</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span>
<span class="w">      </span>
<span class="w">   </span><span class="vc">!_over_⊕</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{A,B} valid (!A⊕!B) ⊸ !(A⊕B)</span><span class=" -MMT_OD">❘</span><span class="w"></span>
<span class="w">            </span><span class="p">=</span><span class="w"> </span><span class=" -MMT_ObjectExpression">[A,B] ⊸_R [ab,h] ⊕_L h ([a,p] !_L p ([pE] !_R (⊕_Rl pE)))</span>
<span class=" -MMT_ObjectExpression">                                     ([b,q] !_L q ([qE] !_R (⊕_Rr qE)))</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">!_over_&amp;</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{A,B} valid !(A&amp;B) ⊸ (!A&amp;!B)</span><span class=" -MMT_OD">❘</span><span class="w"></span>
<span class="w">          </span><span class="cm">// TODO: This proof unexpectedly does not type-check, eventually failing at a=ε and b=ε.</span>
<span class="cm">             Further investigation is needed to determine if the proof is in fact wrong or</span>
<span class="cm">             if the type-checker is led astray by the EquateWorlds rule.</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">          </span><span class="cm">//  = [A,B] ⊸_R [ab,h] &amp;_R (!_L h [pqE] &amp;_Ll pqE ([a,p] !_R p))</span>
<span class="cm">                                   (!_L h [pqE] &amp;_Lr pqE ([b,q] !_R q))❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">!_idempotent1</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{A} valid !!A ⊸ !A</span><span class=" -MMT_OD">❘</span><span class="w"></span>
<span class="w">                 </span><span class="p">=</span><span class="w"> </span><span class=" -MMT_ObjectExpression">[A] ⊸_R [a,h] !_L h [k] !_L k [l] !_R l</span><span class=" -MMT_DD">❙</span><span class="w"> </span>
<span class="w">   </span><span class="vc">!_idempotent2</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{A} valid !A ⊸ !!A</span><span class=" -MMT_OD">❘</span><span class="w"></span>
<span class="w">                 </span><span class="p">=</span><span class="w"> </span><span class=" -MMT_ObjectExpression">[A] ⊸_R [a,h] !_L h [k] !_R (!_R k)</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class="w">   </span><span class="vc">!_weaken</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class=" -MMT_ObjectExpression">{A} valid !A ⊸ A</span><span class=" -MMT_OD">❘</span><span class="w"></span>
<span class="w">            </span><span class="p">=</span><span class="w"> </span><span class=" -MMT_ObjectExpression">[A] ⊸_R [a,h] !_L h [k] k</span><span class=" -MMT_DD">❙</span><span class="w"></span>
<span class=" -MMT_MD">❚</span><span class="w"></span>
</pre></div>
</body>
</html>
